<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wi-Fi Connection Manager Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wi-Fi Connection Manager Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This library provides a set of APIs that can be used to establish and monitor Wi-Fi connections on Cypress platforms that support Wi-Fi connectivity. WCM library APIs are easy to use; in addition, the library provides additional features such as Wi-Fi Protected Setup (WPS) and connection monitoring.</p>
<h1><a class="anchor" id="section_features"></a>
Features and Functionality</h1>
<p>The current implementation has the following features and functionality:</p><ul>
<li>Supports STA, SoftAP, and Concurrent (simultaneous SoftAP + STA) modes.</li>
<li>Support for Wi-Fi Protected Setup (WPS) - Enrollee role.</li>
<li>Exposes Wi-Fi APIs to scan, join, and leave the Wi-Fi network.</li>
<li>Connection monitoring: Monitors active connections and link events. Automatically reconnects to the AP if the connection with the AP is lost intermittently. Notifies the connection state change through event the notification registration mechanism.</li>
<li>This library is part of the AnyCloud framework that supports connectivity applications based on FreeRTOS, lwIP, and mbed TLS.</li>
<li>The library is built on top of the abstraction-rtos library that provides RTOS abstraction API for FreeRTOS.</li>
</ul>
<h1><a class="anchor" id="section_supported_platforms"></a>
Supported Platforms</h1>
<p>This library and its features are supported on the following Cypress platforms:</p><ul>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-6-wi-fi-bt-prototyping-kit-cy8cproto-062-4343w">PSoC 6 Wi-Fi BT Prototyping Kit (CY8CPROTO-062-4343W)</a></li>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-62s2-wi-fi-bt-pioneer-kit-cy8ckit-062s2-43012">PSoC 62S2 Wi-Fi BT Pioneer Kit (CY8CKIT-062S2-43012)</a></li>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-6-wifi-bt-pioneer-kit-cy8ckit-062-wifi-bt">PSoC 6 WiFi-BT Pioneer Kit (CY8CKIT-062-WiFi-BT)</a></li>
</ul>
<h1><a class="anchor" id="section_dependencies"></a>
Dependent Libraries</h1>
<p>This library includes <a href="https://github.com/cypresssemiconductorco/wifi-mw-core">Wi-Fi Middleware Core</a> by default. It helps code examples to enable Wi-Fi connectivity components without having to include additional libraries. The Wi-Fi Host Driver library is part of the Wi-Fi Middleware Core.</p>
<h1><a class="anchor" id="section_integration"></a>
Quick Start</h1>
<ul>
<li>A set of pre-defined configuration files have been bundled with the wifi-mw-core library for FreeRTOS, lwIP, and mbed TLS. The developer is expected to review the configuration and make adjustments. See the Quick Start section in <a href="https://github.com/cypresssemiconductorco/wifi-mw-core/blob/master/README.md">README.md</a>. A set of COMPONENTS must be defined in the code example project's Makefile for this library. See the Quick Start section in <a href="https://github.com/cypresssemiconductorco/wifi-mw-core/blob/master/README.md">README.md</a>. The WCM library disables all the debug log messages by default. To enable log messages, the application must perform the following:<ol type="1">
<li>Add the <code>ENABLE_WCM_LOGS</code> macro to the <em>DEFINES</em> in the code example's Makefile. The Makefile entry would look like as follows: <div class="fragment"><div class="line">DEFINES+=ENABLE_WCM_LOGS</div></div><!-- fragment --></li>
<li>Call the <code>cy_log_init()</code> function provided by the <em>cy-log</em> module. cy-log is part of the <em>connectivity-utilities</em> library. See *<a href="* https://cypresssemiconductorco.github.io/connectivity-utilities/api_reference_manual/html/group__logging__utils.html">connectivity-utilities library API documentation</a>.</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="section_code_snippet"></a>
Code Snippets</h1>
<h2><a class="anchor" id="snip1"></a>
Snippet 1: Scan for All APs</h2>
<p>The following snippet demonstrates how to initialize the Wi-Fi device and network stack, and starts scanning for APs without any filters. The scan_callback receives the scan results and prints them over the serial terminal.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* Scan callback function */</span></div><div class="line"><span class="keywordtype">void</span> scan_callback(<a class="code" href="structcy__wcm__scan__result__t.html">cy_wcm_scan_result_t</a> *result_ptr, <span class="keywordtype">void</span> *user_data, <a class="code" href="group__group__wcm__enums.html#ga24a4ed65a9261c45abc8aa697eb2b8a2">cy_wcm_scan_status_t</a> status)</div><div class="line">{</div><div class="line">    <span class="comment">/* Print the scan result only when scan is incomplete because on scan completion</span></div><div class="line"><span class="comment">     * the contents of result_ptr are empty.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">if</span> (status == <a class="code" href="group__group__wcm__enums.html#gga24a4ed65a9261c45abc8aa697eb2b8a2a01103577816da05a7b2b9521576c3c6e">CY_WCM_SCAN_INCOMPLETE</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot; %-32s     %4d     %2d\n&quot;</span>,</div><div class="line">               result_ptr-&gt;<a class="code" href="structcy__wcm__scan__result__t.html#adcf0e592c5ea946e9ce821b6a13262d4">SSID</a>, result_ptr-&gt;<a class="code" href="structcy__wcm__scan__result__t.html#ac2d508f92bd91a322db54d59f9c42ce5">signal_strength</a>, result_ptr-&gt;<a class="code" href="structcy__wcm__scan__result__t.html#a2c07eb8659b1c9e79cd41b141ab7a52d">channel</a>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_scan_without_filter()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device as a STA.*/</span></div><div class="line">    <a class="code" href="structcy__wcm__config__t.html">cy_wcm_config_t</a> config = {.<a class="code" href="structcy__wcm__config__t.html#ab516902a377cf7b51d1965183c0bfc2f">interface</a> = <a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>};</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device, Wi-Fi transport, and lwIP network stack.*/</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga888428a2325f131528f7447e894002eb">cy_wcm_init</a>(&amp;config);</div><div class="line">    <span class="keywordflow">if</span>(result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_init failed....!\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="comment">/* Filter is set to NULL.*/</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#gae0f0b5f3e6138bfdae943e9f7b16aa07">cy_wcm_start_scan</a>(scan_callback, NULL, NULL);</div><div class="line">    <span class="keywordflow">if</span>(result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_start_scan failed....!\n&quot;</span>);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip2"></a>
Snippet 2: Scan for a Specific AP</h2>
<p>The following snippet demonstrates the configuration of a scan filter to filter by the SSID provided and start a scan. The scan_callback receives the scan results and prints them over the serial terminal.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_scan_with_ssid_filter()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line">    <a class="code" href="structcy__wcm__scan__filter__t.html">cy_wcm_scan_filter_t</a> scan_filter;</div><div class="line"></div><div class="line">    <span class="comment">/* SSID value which is used to filter the scan results.*/</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="group__group__wcm__typedefs.html#ga1ebac1800928741a07555a14539f3748">cy_wcm_ssid_t</a> ssid = <span class="stringliteral">&quot;SSID&quot;</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Configure the scan filter specified by the variable ssid.*/</span></div><div class="line">    scan_filter.<a class="code" href="structcy__wcm__scan__filter__t.html#a019063e2d7ac38f8123fa6181afc45b8">mode</a> = <a class="code" href="group__group__wcm__enums.html#gga568b22d5d446e751f62efe4eb021d451ae6a7c2fd74a727b9d1f3e0261533a7c4">CY_WCM_SCAN_FILTER_TYPE_SSID</a>;</div><div class="line">    memcpy(scan_filter.<a class="code" href="structcy__wcm__scan__filter__t.html#a5c9dfdbc17237085973999b63d9b28e5">param</a>.<a class="code" href="structcy__wcm__scan__filter__t.html#ad8d3cb78527ac618f0a3994ac497cc35">SSID</a>, ssid, <span class="keyword">sizeof</span>(<a class="code" href="group__group__wcm__typedefs.html#ga1ebac1800928741a07555a14539f3748">cy_wcm_ssid_t</a>));</div><div class="line">    printf(<span class="stringliteral">&quot;\n---------------------------------------------------------------------------------\n&quot;</span></div><div class="line">           <span class="stringliteral">&quot;                  SSID                  RSSI   Channel      \n&quot;</span></div><div class="line">           <span class="stringliteral">&quot;---------------------------------------------------------------------------------\n&quot;</span>);</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#gae0f0b5f3e6138bfdae943e9f7b16aa07">cy_wcm_start_scan</a>(scan_callback, NULL, &amp;scan_filter);</div><div class="line">    <span class="keywordflow">if</span>(result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_start_scan failed....!\n&quot;</span>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="snip3"></a>
Snippet 3: Connect to an AP</h2>
<p>The following snippet demonstrates scanning for WIFI_SSID to get the security type of the AP and then connect to it. After a successful connection, the device registers an event callback through which the middleware notifies the application on disconnection, reconnection, and IP change events. If the connection to AP fails, it is retried up to MAX_WIFI_RETRY_COUNT times before reporting failure.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* Wi-Fi Credentials: Modify WIFI_SSID and WIFI_PASSWORD to match your Wi-Fi network</span></div><div class="line"><span class="comment"> * credentials.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define WIFI_SSID                           &quot;SSID&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_PASSWORD                       &quot;PASSWORD&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define MAX_WIFI_RETRY_COUNT                (3u)</span></div><div class="line"><span class="preprocessor">#define WIFI_CONN_RETRY_INTERVAL_MSEC       (100u)</span></div><div class="line"></div><div class="line"><span class="comment">/* The size of the cy_wcm_ip_address_t array that is passed to</span></div><div class="line"><span class="comment"> * cy_wcm_get_ip_addr API. In the case of stand-alone AP or STA mode, the size of</span></div><div class="line"><span class="comment"> * the array is 1. In concurrent AP/STA mode, the size of the array is 2 where</span></div><div class="line"><span class="comment"> * the first index stores the IP address of the STA and the second index</span></div><div class="line"><span class="comment"> * stores the IP address of the AP.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define SIZE_OF_IP_ARRAY_STA                (1u)</span></div><div class="line"></div><div class="line"><span class="comment">/* Scan callback function */</span></div><div class="line"><span class="keywordtype">void</span> scan_to_get_security(<a class="code" href="structcy__wcm__scan__result__t.html">cy_wcm_scan_result_t</a> *result_ptr, <span class="keywordtype">void</span> *user_data, <a class="code" href="group__group__wcm__enums.html#ga24a4ed65a9261c45abc8aa697eb2b8a2">cy_wcm_scan_status_t</a> status)</div><div class="line">{</div><div class="line">    <a class="code" href="group__group__wcm__enums.html#ga8b22f5a47073d5219440566d0e53e521">cy_wcm_security_t</a>* security = (<a class="code" href="group__group__wcm__enums.html#ga8b22f5a47073d5219440566d0e53e521">cy_wcm_security_t</a> *)user_data;</div><div class="line">    <span class="comment">/* Scan for SSID and pass the security type through user_data.*/</span></div><div class="line">    <span class="keywordflow">if</span> ((strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)result_ptr-&gt;<a class="code" href="structcy__wcm__scan__result__t.html#adcf0e592c5ea946e9ce821b6a13262d4">SSID</a>) != 0) &amp;&amp; (status == <a class="code" href="group__group__wcm__enums.html#gga24a4ed65a9261c45abc8aa697eb2b8a2a01103577816da05a7b2b9521576c3c6e">CY_WCM_SCAN_INCOMPLETE</a>))</div><div class="line">    {</div><div class="line">        *security = result_ptr-&gt;<a class="code" href="structcy__wcm__scan__result__t.html#a0bdbcaaaab6950223ad759eb1315daf2">security</a>;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga6c18f6560c581912393e297b1560d3c7">cy_wcm_stop_scan</a>();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> network_event_callback(<a class="code" href="group__group__wcm__enums.html#gafada6a09a78bd0473f3daef54621567f">cy_wcm_event_t</a> event, <a class="code" href="unioncy__wcm__event__data__t.html">cy_wcm_event_data_t</a> *event_data)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa206d74c35be5bf29e7903367287efc79">CY_WCM_EVENT_DISCONNECTED</a> == event)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Disconnected from Wi-Fi\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fab2e59655829c24bd5d0ea68622c8c56e">CY_WCM_EVENT_RECONNECTED</a> == event)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Reconnected to Wi-Fi.\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="comment">/* This event corresponds to the event when the IP address of the device</span></div><div class="line"><span class="comment">     * changes.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafe83442aa63aa747c3025d0874482c86">CY_WCM_EVENT_IP_CHANGED</a> == event)</div><div class="line">    {</div><div class="line">        <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, SIZE_OF_IP_ARRAY_STA);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fca579126d4304962b6ee0f286e5afcbe8a">CY_WCM_IP_VER_V4</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;IP Address: %d.%d.%d.%d\n&quot;</span>, (uint8_t)event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>,</div><div class="line">                   (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 8), (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 16),</div><div class="line">                   (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 24));</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fcaa76a9ec3e0ee840982c8094f4416f768">CY_WCM_IP_VER_V6</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;IP Address: %lX:%lX:%lX:%lX\n&quot;</span>, event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[0],</div><div class="line">                   (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[1]), (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[2]),</div><div class="line">                   (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[3]));</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_connect_ap()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line">    <a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a> connect_param;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_address;</div><div class="line">    <a class="code" href="group__group__wcm__enums.html#ga8b22f5a47073d5219440566d0e53e521">cy_wcm_security_t</a> security;</div><div class="line">    <a class="code" href="structcy__wcm__scan__filter__t.html">cy_wcm_scan_filter_t</a> scan_filter;</div><div class="line"></div><div class="line">    <span class="comment">/* Configure the scan filter specified by the macro WIFI_SSID.*/</span></div><div class="line">    scan_filter.<a class="code" href="structcy__wcm__scan__filter__t.html#a019063e2d7ac38f8123fa6181afc45b8">mode</a> = <a class="code" href="group__group__wcm__enums.html#gga568b22d5d446e751f62efe4eb021d451ae6a7c2fd74a727b9d1f3e0261533a7c4">CY_WCM_SCAN_FILTER_TYPE_SSID</a>;</div><div class="line">    memcpy(scan_filter.<a class="code" href="structcy__wcm__scan__filter__t.html#a5c9dfdbc17237085973999b63d9b28e5">param</a>.<a class="code" href="structcy__wcm__scan__filter__t.html#ad8d3cb78527ac618f0a3994ac497cc35">SSID</a>, WIFI_SSID, <span class="keyword">sizeof</span>(WIFI_SSID));</div><div class="line"></div><div class="line">    <span class="comment">/* Scan with the filter to obtain the security type. The function waits</span></div><div class="line"><span class="comment">     * until the security type is obtained in scan_to_get_security.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <a class="code" href="group__group__wcm__functions.html#gae0f0b5f3e6138bfdae943e9f7b16aa07">cy_wcm_start_scan</a>(scan_to_get_security, (<span class="keywordtype">void</span> *)(&amp;security), &amp;scan_filter);</div><div class="line">    xTaskNotifyWait(0, 0, NULL, portMAX_DELAY);</div><div class="line"></div><div class="line">    memset(&amp;connect_param, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a>));</div><div class="line">    memset(&amp;ip_address, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a>));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID, <span class="keyword">sizeof</span>(WIFI_SSID));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_PASSWORD, <span class="keyword">sizeof</span>(WIFI_PASSWORD));</div><div class="line">    connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = security;</div><div class="line"></div><div class="line">    <span class="comment">/* Attempt to connect to Wi-Fi until a connection is made or </span></div><div class="line"><span class="comment">     * MAX_WIFI_RETRY_COUNT attempts have been made.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">for</span> (uint32_t conn_retries = 0; conn_retries &lt; MAX_WIFI_RETRY_COUNT; conn_retries++)</div><div class="line">    {</div><div class="line">        result = <a class="code" href="group__group__wcm__functions.html#ga9e8e04210ba0fc7429473d28d4643c7c">cy_wcm_connect_ap</a>(&amp;connect_param, &amp;ip_address);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Successfully connected to Wi-Fi network &#39;%s&#39;.\n&quot;</span>, connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>);</div><div class="line"></div><div class="line">            <span class="comment">/* Register event callbacks for changes in the Wi-Fi link status. These</span></div><div class="line"><span class="comment">             * events could be related to IP address changes, connection, and</span></div><div class="line"><span class="comment">             * disconnection events.</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            <a class="code" href="group__group__wcm__functions.html#ga02f205b4d522c99d6c0b48f15683b0b6">cy_wcm_register_event_callback</a>(network_event_callback);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Connection to Wi-Fi network failed with error code %d.&quot;</span></div><div class="line">                <span class="stringliteral">&quot;Retrying in %d ms...\n&quot;</span>, (<span class="keywordtype">int</span>)result, WIFI_CONN_RETRY_INTERVAL_MSEC);</div><div class="line"></div><div class="line">        vTaskDelay(pdMS_TO_TICKS(WIFI_CONN_RETRY_INTERVAL_MSEC));</div><div class="line">    }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip4"></a>
Snippet 4: Connect to an AP using WPS-Push Button</h2>
<p>The following snippet demonstrates joining an AP and obtaining its credentials through WPS using the push button mode. The credentials obtained are printed on the serial terminal.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* The value of this macro specifies the maximum number of Wi-Fi networks the</span></div><div class="line"><span class="comment"> * device can join through WPS in one call to cy_wcm_wps_enrollee. This value is</span></div><div class="line"><span class="comment"> * 2 for dual-band AP. Note that the device can obtain Wi-Fi credentials of only</span></div><div class="line"><span class="comment"> * one network and therefore can receive a maximum of 1 for single-band Wi-Fi AP or</span></div><div class="line"><span class="comment"> * 2 for dual-band AP.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define MAX_WIFI_CREDENTIALS_COUNT          (2)</span></div><div class="line"></div><div class="line"><span class="comment">/* Device&#39;s enrollee details. Details of WPS mode, WPS authentication, and</span></div><div class="line"><span class="comment"> * encryption methods supported are provided in this structure.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="structcy__wcm__wps__device__detail__t.html">cy_wcm_wps_device_detail_t</a> enrollee_details =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__wcm__wps__device__detail__t.html#af691ce3681ce5c0307f43576271b61b8">device_name</a>               = <span class="stringliteral">&quot;PSoC 6&quot;</span>,</div><div class="line">    .manufacturer              = <span class="stringliteral">&quot;Cypress&quot;</span>,</div><div class="line">    .model_name                = <span class="stringliteral">&quot;PSoC 6&quot;</span>,</div><div class="line">    .model_number              = <span class="stringliteral">&quot;1.0&quot;</span>,</div><div class="line">    .serial_number             = <span class="stringliteral">&quot;1234567&quot;</span>,</div><div class="line">    .device_category           = <a class="code" href="group__group__wcm__enums.html#gga2109f4415e7d9d586336f8c4415a270ea38c2c17db9981b8d58c56a03d9eea174">CY_WCM_WPS_DEVICE_COMPUTER</a>,</div><div class="line">    .sub_category              = 7,</div><div class="line">    .config_methods            = <a class="code" href="group__group__wcm__enums.html#ggafef6a7e734e688418bfa6c601edf2cf1ace529442cbd31b83e4ac5a4b3ed33e0a">CY_WCM_WPS_CONFIG_LABEL</a> | <a class="code" href="group__group__wcm__enums.html#ggafef6a7e734e688418bfa6c601edf2cf1aaa30b78f42df81269f3c1b4e2cb8b563">CY_WCM_WPS_CONFIG_VIRTUAL_PUSH_BUTTON</a> | <a class="code" href="group__group__wcm__enums.html#ggafef6a7e734e688418bfa6c601edf2cf1aadb10bf953fe76e72cbf4dcddfbc38df">CY_WCM_WPS_CONFIG_VIRTUAL_DISPLAY_PIN</a>,</div><div class="line">    .authentication_type_flags = <a class="code" href="group__group__wcm__enums.html#ggab50f2a67cec69a058057fc5fc6c5cea1a9936e971dccb38e7cf02448690e11359">CY_WCM_WPS_OPEN_AUTHENTICATION</a> | <a class="code" href="group__group__wcm__enums.html#ggab50f2a67cec69a058057fc5fc6c5cea1a97ad9d0d773ae0615f119a19c92b902e">CY_WCM_WPS_WPA_PSK_AUTHENTICATION</a> | <a class="code" href="group__group__wcm__enums.html#ggab50f2a67cec69a058057fc5fc6c5cea1a56f28a09b4389cd4b9a16e8d443c962a">CY_WCM_WPS_WPA2_PSK_AUTHENTICATION</a> | <a class="code" href="group__group__wcm__enums.html#ggab50f2a67cec69a058057fc5fc6c5cea1a89ef5b1e77a439a54f7fae94a2b0dd87">CY_WCM_WPS_WPA2_WPA_PSK_MIXED_AUTHENTICATION</a>,</div><div class="line">    .encryption_type_flags     = <a class="code" href="group__group__wcm__enums.html#gga7ef358e8ada90c5a7d7a170d9c87f06fadecaa9e74027491e62c637b65f7f6cbd">CY_WCM_WPS_NO_ENCRYPTION</a> | <a class="code" href="group__group__wcm__enums.html#gga7ef358e8ada90c5a7d7a170d9c87f06fa03e109443caa4e7956944d22e3a00c36">CY_WCM_WPS_AES_ENCRYPTION</a> | <a class="code" href="group__group__wcm__enums.html#gga7ef358e8ada90c5a7d7a170d9c87f06fa8a6bf58d9350921fec4e196d35803a7d">CY_WCM_WPS_TKIP_ENCRYPTION</a></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_wps_pbc()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <span class="comment">/* Store the credentials obtained through WPS.*/</span></div><div class="line">    <a class="code" href="structcy__wcm__wps__credential__t.html">cy_wcm_wps_credential_t</a> credentials[MAX_WIFI_CREDENTIALS_COUNT];</div><div class="line">    <a class="code" href="structcy__wcm__wps__config__t.html">cy_wcm_wps_config_t</a> wps_config;</div><div class="line"></div><div class="line">    <span class="comment">/* Store the PIN used for WPS. It is unused when PBC mode is employed.*/</span></div><div class="line">    <span class="keywordtype">char</span> pin_string[<a class="code" href="group__group__wcm__macros.html#ga2fd33d6cf6472c7452a22e5988e69516">CY_WCM_WPS_PIN_LENGTH</a>];</div><div class="line">    uint16_t credential_count = MAX_WIFI_CREDENTIALS_COUNT;</div><div class="line"></div><div class="line">    <span class="comment">/*Configure the mode of the WPS as CY_WCM_WPS_PBC_MODE.*/</span></div><div class="line">    wps_config.<a class="code" href="structcy__wcm__wps__config__t.html#ad45eecaffb10e893f240bf42c05c453b">mode</a> = <a class="code" href="group__group__wcm__enums.html#gga522893594393679bacaaaa77d81b26f8a31835b09070e6bd6c1728168e549c09c">CY_WCM_WPS_PBC_MODE</a>;</div><div class="line">    wps_config.<a class="code" href="structcy__wcm__wps__config__t.html#ac9878359549a01538c7a9bcda83abde7">password</a> = pin_string;</div><div class="line">    memset(credentials, 0, <span class="keyword">sizeof</span>(credentials));</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;Press the push button on your WPS AP.\n&quot;</span>);</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga97e7212b4d3392a310682ff02f0d8d51">cy_wcm_wps_enrollee</a>(&amp;wps_config, &amp;enrollee_details, credentials, &amp;credential_count);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (CY_RSLT_SUCCESS == result)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;WPS Success.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">/* Print the WPS credentials obtained through WPS.*/</span></div><div class="line">        <span class="keywordflow">for</span> (uint32_t loop = 0; loop &lt; credential_count; loop++)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;%ld. SSID = %s, Password = %c%c******.\n&quot;</span>, loop + 1, credentials[loop].ssid, credentials[loop].passphrase[0], credentials[loop].passphrase[1]);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip5"></a>
Snippet 5: Connect to an AP using WPS-PIN</h2>
<p>The following snippet demonstrates joining an AP and obtaining its credentials through WPS using the PIN mode. The credentials obtained are printed on the serial terminal.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> snippet_wcm_wps_pin()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line">    <a class="code" href="structcy__wcm__wps__credential__t.html">cy_wcm_wps_credential_t</a> credentials[MAX_WIFI_CREDENTIALS_COUNT];</div><div class="line">    <a class="code" href="structcy__wcm__wps__config__t.html">cy_wcm_wps_config_t</a> wps_config;</div><div class="line">    <span class="keywordtype">char</span> pin_string[<a class="code" href="group__group__wcm__macros.html#ga2fd33d6cf6472c7452a22e5988e69516">CY_WCM_WPS_PIN_LENGTH</a>];</div><div class="line">    uint16_t credential_count = MAX_WIFI_CREDENTIALS_COUNT;</div><div class="line"></div><div class="line">    memset(credentials, 0, <span class="keyword">sizeof</span>(credentials));</div><div class="line"></div><div class="line">    <span class="comment">/* Here, the WPS PIN is generated by the device. The user must</span></div><div class="line"><span class="comment">     * enter the PIN in the AP to join the network through WPS.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <a class="code" href="group__group__wcm__functions.html#ga0369189fc2845efdf57cd3ce9b0d188e">cy_wcm_wps_generate_pin</a>(pin_string);</div><div class="line"></div><div class="line">    <span class="comment">/*Configure the mode of WPS as CY_WCM_WPS_PIN_MODE.*/</span></div><div class="line">    wps_config.<a class="code" href="structcy__wcm__wps__config__t.html#ad45eecaffb10e893f240bf42c05c453b">mode</a> = <a class="code" href="group__group__wcm__enums.html#gga522893594393679bacaaaa77d81b26f8a95b8f9041290279c8c309fa985241565">CY_WCM_WPS_PIN_MODE</a>;</div><div class="line">    wps_config.<a class="code" href="structcy__wcm__wps__config__t.html#ac9878359549a01538c7a9bcda83abde7">password</a> = pin_string;</div><div class="line">    printf(<span class="stringliteral">&quot;Enter this PIN: \&#39;%s\&#39; in your AP.\n&quot;</span>, pin_string);</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga97e7212b4d3392a310682ff02f0d8d51">cy_wcm_wps_enrollee</a>(&amp;wps_config, &amp;enrollee_details, credentials, &amp;credential_count);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (CY_RSLT_SUCCESS == result)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;WPS Success.\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">/* Print the WPS credentials obtained through WPS.*/</span></div><div class="line">        <span class="keywordflow">for</span> (uint32_t loop = 0; loop &lt; credential_count; loop++)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;%ld. SSID = %s, Password = %c%c******.\n&quot;</span>, loop + 1, credentials[loop].ssid, credentials[loop].passphrase[0], credentials[loop].passphrase[1]);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip6"></a>
Snippet 6: Pinging Gateway IP address</h2>
<p>The following snippet demonstrates ping to the gateway IP address with a STA mode connection.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define WIFI_SSID                           &quot;SSID&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_PASSWORD                       &quot;PASSWORD&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define MAX_WIFI_RETRY_COUNT                (3u)</span></div><div class="line"><span class="preprocessor">#define WIFI_CONN_RETRY_INTERVAL_MSEC       (100u)</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ip4(uint32_t ip)</div><div class="line">{</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bytes[4];</div><div class="line">    bytes[0] = ip &amp; 0xFF;</div><div class="line">    bytes[1] = (ip &gt;&gt; 8) &amp; 0xFF;</div><div class="line">    bytes[2] = (ip &gt;&gt; 16) &amp; 0xFF;</div><div class="line">    bytes[3] = (ip &gt;&gt; 24) &amp; 0xFF;</div><div class="line">    printf(<span class="stringliteral">&quot;IPV4 addr = %d.%d.%d.%d\n&quot;</span>, bytes[0], bytes[1], bytes[2], bytes[3]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_sta_ping()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device as a STA.*/</span></div><div class="line">    <a class="code" href="structcy__wcm__config__t.html">cy_wcm_config_t</a> config = {.<a class="code" href="structcy__wcm__config__t.html#ab516902a377cf7b51d1965183c0bfc2f">interface</a> = <a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>};</div><div class="line"></div><div class="line">    <a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a> connect_param;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_address;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr, gateway_addr;</div><div class="line">    uint32_t elapsed_time_ms;</div><div class="line"></div><div class="line">    memset(&amp;connect_param, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a>));</div><div class="line">    memset(&amp;ip_address, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a>));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID, <span class="keyword">sizeof</span>(WIFI_SSID));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_PASSWORD, <span class="keyword">sizeof</span>(WIFI_PASSWORD));</div><div class="line">    connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = <a class="code" href="group__group__wcm__enums.html#gga8b22f5a47073d5219440566d0e53e521a772f5ab0cd577a4d8f9426be3123cefe">CY_WCM_SECURITY_WPA2_AES_PSK</a>;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device, Wi-Fi transport, and lwIP network stack.*/</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga888428a2325f131528f7447e894002eb">cy_wcm_init</a>(&amp;config);</div><div class="line">    <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_init failed...!\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;\n*** Starting STA Mode ***\n&quot;</span>);</div><div class="line">    <span class="comment">/* Attempt to connect to Wi-Fi until a connection is made or</span></div><div class="line"><span class="comment">     * MAX_WIFI_RETRY_COUNT attempts have been made.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">for</span> (uint32_t conn_retries = 0; conn_retries &lt; MAX_WIFI_RETRY_COUNT; conn_retries++)</div><div class="line">    {</div><div class="line">        result = <a class="code" href="group__group__wcm__functions.html#ga9e8e04210ba0fc7429473d28d4643c7c">cy_wcm_connect_ap</a>(&amp;connect_param, &amp;ip_address);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Successfully connected to Wi-Fi network &#39;%s&#39;.\n&quot;</span>, connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Connection to Wi-Fi network failed with error code %d.&quot;</span></div><div class="line">                <span class="stringliteral">&quot;Retrying in %d ms...\n&quot;</span>, (<span class="keywordtype">int</span>)result, WIFI_CONN_RETRY_INTERVAL_MSEC);</div><div class="line"></div><div class="line">        vTaskDelay(pdMS_TO_TICKS(WIFI_CONN_RETRY_INTERVAL_MSEC));</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Get IPv4 address */</span></div><div class="line">    <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, 1);</div><div class="line">    print_ip4(ip_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Get gateway address */</span></div><div class="line">    <a class="code" href="group__group__wcm__functions.html#gae5957d81ae8e2cd3b0ee5bac550f03f2">cy_wcm_get_gateway_ip_address</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;gateway_addr, 1);</div><div class="line">    print_ip4(gateway_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line"></div><div class="line">    vTaskDelay(2000);</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;Pinging to gateway IP address ... \n&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">/* Send PING request with 3000ms ping timeout */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#gaa42251a4b728f775786d1781afbc32a2">cy_wcm_ping</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;gateway_addr, 3000, &amp;elapsed_time_ms);</div><div class="line">    <span class="keywordflow">if</span>( result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;ping was successful time elapsed = %lu\n&quot;</span>, elapsed_time_ms);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Ping failed !!\n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip7"></a>
Snippet 7: Soft AP start-stop</h2>
<p>The following snippet demonstrates Soft AP start and stop.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define WIFI_SSID_AP                      &quot;AnyCloud&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_KEY_AP                       &quot;abcd@9009&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define INITIALISER_IPV4_ADDRESS1( addr_var, addr_val )  addr_var = { CY_WCM_IP_VER_V4, { .v4 = (uint32_t)(addr_val) } }</span></div><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS1(a, b, c, d) ((((uint32_t) d) &lt;&lt; 24) | (((uint32_t) c) &lt;&lt; 16) | (((uint32_t) b) &lt;&lt; 8) |((uint32_t) a))</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcy__wcm__ip__setting__t.html">cy_wcm_ip_setting_t</a> ap_mode_ip_settings =</div><div class="line">{</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .ip_address, MAKE_IPV4_ADDRESS1( 192, 168, 0,  2 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .netmask,    MAKE_IPV4_ADDRESS1( 255, 255, 255, 0 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .gateway,    MAKE_IPV4_ADDRESS1( 192, 168, 0, 2 ) ),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#define HTONS(x) ( ( ( (x) &amp; 0x0000FF00) &gt;&gt; 8 ) | ((x) &amp; 0x000000FF) &lt;&lt; 8 )</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ipv6(uint32_t* ipv6)</div><div class="line">{</div><div class="line">    uint16_t* ipv6_ptr = (uint16_t*) ipv6;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;IPV6 Address : %0x, %0x, %0x, %0x, %0x, %0x, %0x, %0x \n&quot;</span>, HTONS(ipv6_ptr[0]), HTONS(ipv6_ptr[1]), HTONS(ipv6_ptr[2]), HTONS(ipv6_ptr[3]), HTONS(ipv6_ptr[4]), HTONS(ipv6_ptr[5]), HTONS(ipv6_ptr[6]), HTONS(ipv6_ptr[7]));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ipv4(uint32_t ip)</div><div class="line">{</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bytes[4];</div><div class="line">    bytes[0] = ip &amp; 0xFF;</div><div class="line">    bytes[1] = (ip &gt;&gt; 8) &amp; 0xFF;</div><div class="line">    bytes[2] = (ip &gt;&gt; 16) &amp; 0xFF;</div><div class="line">    bytes[3] = (ip &gt;&gt; 24) &amp; 0xFF;</div><div class="line">    printf(<span class="stringliteral">&quot;IPV4 addr = %d.%d.%d.%d\n&quot;</span>, bytes[0], bytes[1], bytes[2], bytes[3]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ap_event_cb(<a class="code" href="group__group__wcm__enums.html#gafada6a09a78bd0473f3daef54621567f">cy_wcm_event_t</a> event, <a class="code" href="unioncy__wcm__event__data__t.html">cy_wcm_event_data_t</a> *event_data)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;######### Received event changed from wcm, event = %d #######\n&quot;</span>, event);</div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa206d74c35be5bf29e7903367287efc79">CY_WCM_EVENT_DISCONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is down! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fab2e59655829c24bd5d0ea68622c8c56e">CY_WCM_EVENT_RECONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is up again! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa683d1014dce666536998f4d185975852">CY_WCM_EVENT_CONNECTING</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connecting to AP ... \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa3cb25ea52d7dfe04a55193c5289d501f">CY_WCM_EVENT_CONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connected to AP and network is up !! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafa85fe7467f303e5425b54a8f20072e5">CY_WCM_EVENT_CONNECT_FAILED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connection to AP Failed ! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafe83442aa63aa747c3025d0874482c86">CY_WCM_EVENT_IP_CHANGED</a>)</div><div class="line">    {</div><div class="line">        <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, 1);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fca579126d4304962b6ee0f286e5afcbe8a">CY_WCM_IP_VER_V4</a>)</div><div class="line">        {</div><div class="line">            print_ip4(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa89bf3f175e03aabb5951138e229392c9">CY_WCM_EVENT_STA_JOINED_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which joined = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa54168b9c07156a695d1de5db77f03bcb">CY_WCM_EVENT_STA_LEFT_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which left = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_ap_start_stop()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <a class="code" href="structcy__wcm__config__t.html">cy_wcm_config_t</a> config;</div><div class="line">    <a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a> ap_conf;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ipv6_addr;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device, Wi-Fi transport, and lwIP network stack.*/</span></div><div class="line">    config.<a class="code" href="structcy__wcm__config__t.html#ab516902a377cf7b51d1965183c0bfc2f">interface</a> = <a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>;</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga888428a2325f131528f7447e894002eb">cy_wcm_init</a>(&amp;config);</div><div class="line">    <span class="keywordflow">if</span>(result != CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_init failed...!\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    memset(&amp;ap_conf, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a>));</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a43adeebc56159fdac2d1e0a19334fb6f">channel</a> = 1;</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID_AP, strlen(WIFI_SSID_AP) + 1);</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_KEY_AP, strlen(WIFI_KEY_AP) + 1);</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = <a class="code" href="group__group__wcm__enums.html#gga8b22f5a47073d5219440566d0e53e521a772f5ab0cd577a4d8f9426be3123cefe">CY_WCM_SECURITY_WPA2_AES_PSK</a>;</div><div class="line"></div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a> = ap_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a> = ap_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a> = ap_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a>;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;configured ip address of the AP = %lu \n&quot;</span>, ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">    print_ipv4(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Start AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga4b6c66ca0e28ef817bdab02c56d180e6">cy_wcm_start_ap</a>(&amp;ap_conf);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_start_ap failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register AP event callback */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga02f205b4d522c99d6c0b48f15683b0b6">cy_wcm_register_event_callback</a>(&amp;ap_event_cb);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_register_event_callback failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Link Local IPV6 AP address for AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga6f90e612b2e00a03d13b575a3f759df9">cy_wcm_get_ipv6_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>, <a class="code" href="group__group__wcm__enums.html#gga04051d082e24439e436a17db75fadfefa635adc564bdb3dbdd71685cef4f470ac">CY_WCM_IPV6_LINK_LOCAL</a>, &amp;ipv6_addr, 1);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_ipv6_addr failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    print_ipv6(ipv6_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* wait for 30 seconds to check whether AP is visible or not */</span></div><div class="line">    vTaskDelay(30000);</div><div class="line"></div><div class="line">    <span class="comment">/* Stop AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#gaaf300adeaed2e9251dc85d6c85be9d72">cy_wcm_stop_ap</a>();</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_stop_ap failed....! \n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="snip8"></a>
Snippet 8: Clients connected to the Soft AP</h2>
<p>The following snippet demonstrates usage of API function <a class="el" href="group__group__wcm__functions.html#gac2570e24e41dc550252205489f56cc0f">cy_wcm_get_associated_client_list</a> to get the list of clients connected to the Soft AP.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define WIFI_SSID_AP                      &quot;AnyCloud&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_KEY_AP                       &quot;abcd@9009&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define INITIALISER_IPV4_ADDRESS1( addr_var, addr_val )  addr_var = { CY_WCM_IP_VER_V4, { .v4 = (uint32_t)(addr_val) } }</span></div><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS1(a, b, c, d) ((((uint32_t) d) &lt;&lt; 24) | (((uint32_t) c) &lt;&lt; 16) | (((uint32_t) b) &lt;&lt; 8) |((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcy__wcm__ip__setting__t.html">cy_wcm_ip_setting_t</a> ap_ip_settings =</div><div class="line">{</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .ip_address, MAKE_IPV4_ADDRESS1( 192, 168, 0,  2 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .netmask,    MAKE_IPV4_ADDRESS1( 255, 255, 255, 0 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .gateway,    MAKE_IPV4_ADDRESS1( 192, 168, 0, 2 ) ),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ip_v6(uint32_t* ipv6)</div><div class="line">{</div><div class="line">    uint16_t* ipv6_ptr = (uint16_t*) ipv6;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;IPV6 Address : %0x, %0x, %0x, %0x, %0x, %0x, %0x, %0x \n&quot;</span>, HTONS(ipv6_ptr[0]), HTONS(ipv6_ptr[1]), HTONS(ipv6_ptr[2]), HTONS(ipv6_ptr[3]), HTONS(ipv6_ptr[4]), HTONS(ipv6_ptr[5]), HTONS(ipv6_ptr[6]), HTONS(ipv6_ptr[7]));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ip_v4(uint32_t ip)</div><div class="line">{</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bytes[4];</div><div class="line">    bytes[0] = ip &amp; 0xFF;</div><div class="line">    bytes[1] = (ip &gt;&gt; 8) &amp; 0xFF;</div><div class="line">    bytes[2] = (ip &gt;&gt; 16) &amp; 0xFF;</div><div class="line">    bytes[3] = (ip &gt;&gt; 24) &amp; 0xFF;</div><div class="line">    printf(<span class="stringliteral">&quot;IPV4 addr = %d.%d.%d.%d\n&quot;</span>, bytes[0], bytes[1], bytes[2], bytes[3]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ap_eve_callback(<a class="code" href="group__group__wcm__enums.html#gafada6a09a78bd0473f3daef54621567f">cy_wcm_event_t</a> event, <a class="code" href="unioncy__wcm__event__data__t.html">cy_wcm_event_data_t</a> *event_data)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;######### Received event changed from wcm, event = %d #######\n&quot;</span>, event);</div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa206d74c35be5bf29e7903367287efc79">CY_WCM_EVENT_DISCONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is down! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fab2e59655829c24bd5d0ea68622c8c56e">CY_WCM_EVENT_RECONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is up again! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa683d1014dce666536998f4d185975852">CY_WCM_EVENT_CONNECTING</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connecting to AP ... \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa3cb25ea52d7dfe04a55193c5289d501f">CY_WCM_EVENT_CONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connected to AP and network is up !! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafa85fe7467f303e5425b54a8f20072e5">CY_WCM_EVENT_CONNECT_FAILED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connection to AP Failed ! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafe83442aa63aa747c3025d0874482c86">CY_WCM_EVENT_IP_CHANGED</a>)</div><div class="line">    {</div><div class="line">        <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, 1);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fca579126d4304962b6ee0f286e5afcbe8a">CY_WCM_IP_VER_V4</a>)</div><div class="line">        {</div><div class="line">            print_ip_v4(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa89bf3f175e03aabb5951138e229392c9">CY_WCM_EVENT_STA_JOINED_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which joined = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa54168b9c07156a695d1de5db77f03bcb">CY_WCM_EVENT_STA_LEFT_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which left = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_ap_get_client()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <a class="code" href="structcy__wcm__config__t.html">cy_wcm_config_t</a> config;</div><div class="line">    <a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a> ap_conf;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ipv6_addr;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device, Wi-Fi transport, and lwIP network stack.*/</span></div><div class="line">    config.<a class="code" href="structcy__wcm__config__t.html#ab516902a377cf7b51d1965183c0bfc2f">interface</a> = <a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>;</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga888428a2325f131528f7447e894002eb">cy_wcm_init</a>(&amp;config);</div><div class="line">    <span class="keywordflow">if</span>(result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_init failed...!\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    memset(&amp;ap_conf, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a>));</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a43adeebc56159fdac2d1e0a19334fb6f">channel</a> = 1;</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID_AP, strlen(WIFI_SSID_AP) + 1);</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_KEY_AP, strlen(WIFI_KEY_AP) + 1);</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = <a class="code" href="group__group__wcm__enums.html#gga8b22f5a47073d5219440566d0e53e521a772f5ab0cd577a4d8f9426be3123cefe">CY_WCM_SECURITY_WPA2_AES_PSK</a>;</div><div class="line"></div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a> = ap_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a> = ap_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a> = ap_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a>;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;configured ip address of the AP = %lu \n&quot;</span>, ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">    print_ip_v4(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Start AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga4b6c66ca0e28ef817bdab02c56d180e6">cy_wcm_start_ap</a>(&amp;ap_conf);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_start_ap failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register AP event callback */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga02f205b4d522c99d6c0b48f15683b0b6">cy_wcm_register_event_callback</a>(&amp;ap_eve_callback);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_register_event_callback failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Link Local IPV6 AP address for AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga6f90e612b2e00a03d13b575a3f759df9">cy_wcm_get_ipv6_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>, <a class="code" href="group__group__wcm__enums.html#gga04051d082e24439e436a17db75fadfefa635adc564bdb3dbdd71685cef4f470ac">CY_WCM_IPV6_LINK_LOCAL</a>, &amp;ipv6_addr, 1);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_ipv6_addr failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    print_ip_v6(ipv6_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* wait for 30 seconds for a client to connect */</span></div><div class="line">    vTaskDelay(30000);</div><div class="line"></div><div class="line">    <span class="comment">/* get connected client */</span></div><div class="line">    <a class="code" href="group__group__wcm__typedefs.html#ga510db2323122294f3956024396ba2ff5">cy_wcm_mac_t</a> mac_add;</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#gac2570e24e41dc550252205489f56cc0f">cy_wcm_get_associated_client_list</a>(&amp;mac_add, 1);</div><div class="line">    <span class="keywordflow">if</span>( result != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_associated_client_list failed....! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;mac address obtained from cy_wcm_get_associated_client_list = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">            mac_add[0], mac_add[1], mac_add[2],mac_add[3], mac_add[4], mac_add[5]);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="snip9"></a>
Snippet 9: AP+STA concurrent mode</h2>
<p>The following snippet demonstrates AP+STA concurrent mode operation.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* Wi-Fi Credentials: Modify WIFI_SSID and WIFI_PASSWORD to match your Wi-Fi network</span></div><div class="line"><span class="comment"> * credentials.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define WIFI_SSID                           &quot;SSID&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_PASSWORD                       &quot;PASSWORD&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_SSID_AP                        &quot;AnyCloud&quot;</span></div><div class="line"><span class="preprocessor">#define WIFI_KEY_AP                         &quot;abcd@9009&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define MAX_WIFI_RETRY_COUNT                (3u)</span></div><div class="line"><span class="preprocessor">#define WIFI_CONN_RETRY_INTERVAL_MSEC       (100u)</span></div><div class="line"></div><div class="line"><span class="comment">/* The size of the cy_wcm_ip_address_t array that is passed to</span></div><div class="line"><span class="comment"> * cy_wcm_get_ip_addr API. In the case of stand-alone AP or STA mode, the size of</span></div><div class="line"><span class="comment"> * the array is 1. In concurrent AP/STA mode, the size of the array is 2 where</span></div><div class="line"><span class="comment"> * the first index stores the IP address of the STA and the second index</span></div><div class="line"><span class="comment"> * stores the IP address of the AP.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define SIZE_OF_IP_ARRAY_STA                (1u)</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define INITIALISER_IPV4_ADDRESS1( addr_var, addr_val )  addr_var = { CY_WCM_IP_VER_V4, { .v4 = (uint32_t)(addr_val) } }</span></div><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS1(a, b, c, d) ((((uint32_t) d) &lt;&lt; 24) | (((uint32_t) c) &lt;&lt; 16) | (((uint32_t) b) &lt;&lt; 8) |((uint32_t) a))</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcy__wcm__ip__setting__t.html">cy_wcm_ip_setting_t</a> ap_sta_mode_ip_settings =</div><div class="line">{</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .ip_address, MAKE_IPV4_ADDRESS1( 192, 168, 0,  2 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .netmask,    MAKE_IPV4_ADDRESS1( 255, 255, 255, 0 )),</div><div class="line">    INITIALISER_IPV4_ADDRESS1( .gateway,    MAKE_IPV4_ADDRESS1( 192, 168, 0, 2 ) ),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ip_6(uint32_t* ipv6)</div><div class="line">{</div><div class="line">    uint16_t* ipv6_ptr = (uint16_t*) ipv6;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;IPV6 Address : %0x, %0x, %0x, %0x, %0x, %0x, %0x, %0x \n&quot;</span>, HTONS(ipv6_ptr[0]), HTONS(ipv6_ptr[1]), HTONS(ipv6_ptr[2]), HTONS(ipv6_ptr[3]), HTONS(ipv6_ptr[4]), HTONS(ipv6_ptr[5]), HTONS(ipv6_ptr[6]), HTONS(ipv6_ptr[7]));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_ip_4(uint32_t ip)</div><div class="line">{</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bytes[4];</div><div class="line">    bytes[0] = ip &amp; 0xFF;</div><div class="line">    bytes[1] = (ip &gt;&gt; 8) &amp; 0xFF;</div><div class="line">    bytes[2] = (ip &gt;&gt; 16) &amp; 0xFF;</div><div class="line">    bytes[3] = (ip &gt;&gt; 24) &amp; 0xFF;</div><div class="line">    printf(<span class="stringliteral">&quot;IPV4 addr = %d.%d.%d.%d\n&quot;</span>, bytes[0], bytes[1], bytes[2], bytes[3]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> sta_event_callback(<a class="code" href="group__group__wcm__enums.html#gafada6a09a78bd0473f3daef54621567f">cy_wcm_event_t</a> event, <a class="code" href="unioncy__wcm__event__data__t.html">cy_wcm_event_data_t</a> *event_data)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa206d74c35be5bf29e7903367287efc79">CY_WCM_EVENT_DISCONNECTED</a> == event)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Disconnected from Wi-Fi\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fab2e59655829c24bd5d0ea68622c8c56e">CY_WCM_EVENT_RECONNECTED</a> == event)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Reconnected to Wi-Fi.\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="comment">/* This event corresponds to the event when the IP address of the device</span></div><div class="line"><span class="comment">     * changes.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafe83442aa63aa747c3025d0874482c86">CY_WCM_EVENT_IP_CHANGED</a> == event)</div><div class="line">    {</div><div class="line">        <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, SIZE_OF_IP_ARRAY_STA);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fca579126d4304962b6ee0f286e5afcbe8a">CY_WCM_IP_VER_V4</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;IP Address: %d.%d.%d.%d\n&quot;</span>, (uint8_t)event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>,</div><div class="line">                   (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 8), (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 16),</div><div class="line">                   (uint8_t)(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a> &gt;&gt; 24));</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fcaa76a9ec3e0ee840982c8094f4416f768">CY_WCM_IP_VER_V6</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;IP Address: %lX:%lX:%lX:%lX\n&quot;</span>, event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[0],</div><div class="line">                   (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[1]), (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[2]),</div><div class="line">                   (event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>[3]));</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ap_event_callback(<a class="code" href="group__group__wcm__enums.html#gafada6a09a78bd0473f3daef54621567f">cy_wcm_event_t</a> event, <a class="code" href="unioncy__wcm__event__data__t.html">cy_wcm_event_data_t</a> *event_data)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;######### Received event changed from wcm, event = %d #######\n&quot;</span>, event);</div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa206d74c35be5bf29e7903367287efc79">CY_WCM_EVENT_DISCONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is down! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fab2e59655829c24bd5d0ea68622c8c56e">CY_WCM_EVENT_RECONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Network is up again! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa683d1014dce666536998f4d185975852">CY_WCM_EVENT_CONNECTING</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connecting to AP ... \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa3cb25ea52d7dfe04a55193c5289d501f">CY_WCM_EVENT_CONNECTED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connected to AP and network is up !! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafa85fe7467f303e5425b54a8f20072e5">CY_WCM_EVENT_CONNECT_FAILED</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Connection to AP Failed ! \n&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fafe83442aa63aa747c3025d0874482c86">CY_WCM_EVENT_IP_CHANGED</a>)</div><div class="line">    {</div><div class="line">        <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_addr;</div><div class="line">        <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, &amp;ip_addr, 1);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a7c275791b147e4ccd77ad178dd25bf81">version</a> == <a class="code" href="group__group__wcm__enums.html#gga24d3def17207a3c64b62fb4b8a44a7fca579126d4304962b6ee0f286e5afcbe8a">CY_WCM_IP_VER_V4</a>)</div><div class="line">        {</div><div class="line">            print_ip_4(event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#a9c8f9a98e351394d704d1796328ae466">ip_addr</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa89bf3f175e03aabb5951138e229392c9">CY_WCM_EVENT_STA_JOINED_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which joined = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(event == <a class="code" href="group__group__wcm__enums.html#ggafada6a09a78bd0473f3daef54621567fa54168b9c07156a695d1de5db77f03bcb">CY_WCM_EVENT_STA_LEFT_SOFTAP</a>)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;mac address of the STA which left = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[0], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[1], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[2],</div><div class="line">                event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[3], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[4], event_data-&gt;<a class="code" href="unioncy__wcm__event__data__t.html#aa2f4d769a35b7859bf0649d29b5f46a4">sta_mac</a>[5]);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_wcm_concurrent_mode()</div><div class="line">{</div><div class="line">    cy_rslt_t result;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device as a STA.*/</span></div><div class="line">    <a class="code" href="structcy__wcm__config__t.html">cy_wcm_config_t</a> config = {.<a class="code" href="structcy__wcm__config__t.html#ab516902a377cf7b51d1965183c0bfc2f">interface</a> = <a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a864e150cea33f5d4cae3e6834bf56f2e">CY_WCM_INTERFACE_TYPE_AP_STA</a>};</div><div class="line">    <a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a> ap_conf;</div><div class="line">    <a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a> connect_param;</div><div class="line">    <a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a> ip_address,ipv4_addr,ipv6_addr;</div><div class="line">    <a class="code" href="group__group__wcm__enums.html#ga8b22f5a47073d5219440566d0e53e521">cy_wcm_security_t</a> security;</div><div class="line"></div><div class="line">    memset(&amp;connect_param, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__connect__params__t.html">cy_wcm_connect_params_t</a>));</div><div class="line">    memset(&amp;ip_address, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a>));</div><div class="line">    memset(&amp;security, 0, <span class="keyword">sizeof</span>(<a class="code" href="group__group__wcm__enums.html#ga8b22f5a47073d5219440566d0e53e521">cy_wcm_security_t</a>));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID, <span class="keyword">sizeof</span>(WIFI_SSID));</div><div class="line">    memcpy(connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_PASSWORD, <span class="keyword">sizeof</span>(WIFI_PASSWORD));</div><div class="line">    connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = security;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the Wi-Fi device, Wi-Fi transport, and lwIP network stack.*/</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga888428a2325f131528f7447e894002eb">cy_wcm_init</a>(&amp;config);</div><div class="line">    <span class="keywordflow">if</span>(result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_init failed...!\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;\n*** Starting STA Mode ***\n&quot;</span>);</div><div class="line">    <span class="comment">/* Attempt to connect to Wi-Fi until a connection is made or</span></div><div class="line"><span class="comment">     * MAX_WIFI_RETRY_COUNT attempts have been made.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">for</span> (uint32_t conn_retries = 0; conn_retries &lt; MAX_WIFI_RETRY_COUNT; conn_retries++)</div><div class="line">    {</div><div class="line">        result = <a class="code" href="group__group__wcm__functions.html#ga9e8e04210ba0fc7429473d28d4643c7c">cy_wcm_connect_ap</a>(&amp;connect_param, &amp;ip_address);</div><div class="line">        <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Successfully connected to Wi-Fi network &#39;%s&#39;.\n&quot;</span>, connect_param.<a class="code" href="structcy__wcm__connect__params__t.html#add927d1d5bbaf348296daad9a6312023">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>);</div><div class="line"></div><div class="line">            <span class="comment">/* Register event callbacks for changes in the Wi-Fi link status. These</span></div><div class="line"><span class="comment">             * events could be related to IP address changes, connection, and</span></div><div class="line"><span class="comment">             * disconnection events.</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            <a class="code" href="group__group__wcm__functions.html#ga02f205b4d522c99d6c0b48f15683b0b6">cy_wcm_register_event_callback</a>(sta_event_callback);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Connection to Wi-Fi network failed with error code %d.&quot;</span></div><div class="line">                <span class="stringliteral">&quot;Retrying in %d ms...\n&quot;</span>, (<span class="keywordtype">int</span>)result, WIFI_CONN_RETRY_INTERVAL_MSEC);</div><div class="line"></div><div class="line">        vTaskDelay(pdMS_TO_TICKS(WIFI_CONN_RETRY_INTERVAL_MSEC));</div><div class="line">    }</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;\n*** Starting AP Mode ***\n&quot;</span>);</div><div class="line">    memset(&amp;ap_conf, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ap__config__t.html">cy_wcm_ap_config_t</a>));</div><div class="line">    memset(&amp;ipv4_addr, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a>));</div><div class="line">    memset(&amp;ipv6_addr, 0, <span class="keyword">sizeof</span>(<a class="code" href="structcy__wcm__ip__address__t.html">cy_wcm_ip_address_t</a>));</div><div class="line"></div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a43adeebc56159fdac2d1e0a19334fb6f">channel</a> = 1;</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#aefb4693ca1fa808349032561a2e4b3bc">SSID</a>, WIFI_SSID_AP, strlen(WIFI_SSID_AP) + 1);</div><div class="line">    memcpy(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#ad9ba797a8bc9bcb7708eb9b4560e3095">password</a>, WIFI_KEY_AP, strlen(WIFI_KEY_AP) + 1);</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a41b9a70a96b5567416a37661a84b3e7c">ap_credentials</a>.<a class="code" href="structcy__wcm__ap__credentials__t.html#a576fbc5a934d7efe6c98e265678c38d9">security</a> = <a class="code" href="group__group__wcm__enums.html#gga8b22f5a47073d5219440566d0e53e521a772f5ab0cd577a4d8f9426be3123cefe">CY_WCM_SECURITY_WPA2_AES_PSK</a>;</div><div class="line"></div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a> = ap_sta_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a> = ap_sta_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a56bf0370a561c858da2008255d0f12bc">netmask</a>;</div><div class="line">    ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a> = ap_sta_mode_ip_settings.<a class="code" href="structcy__wcm__ip__setting__t.html#a2e28eec7ae6e6301101991039b5b3bd0">gateway</a>;</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;configured ip address of the AP = %lu \n&quot;</span>, ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">    print_ip4(ap_conf.<a class="code" href="structcy__wcm__ap__config__t.html#a4d26be457ca32e36d8162c3eb347491b">ip_settings</a>.<a class="code" href="structcy__wcm__ip__setting__t.html#aab6aea9cfd72daa55d92f86046e594dd">ip_address</a>.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line">    <a class="code" href="group__group__wcm__functions.html#ga02f205b4d522c99d6c0b48f15683b0b6">cy_wcm_register_event_callback</a>(&amp;ap_event_callback);</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga4b6c66ca0e28ef817bdab02c56d180e6">cy_wcm_start_ap</a>(&amp;ap_conf);</div><div class="line">    <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_start_ap failed...! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;\nAP started successfully... \n&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">/* Get IPV4 address for AP */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga684ba6f1f1814d29775abaca9a029cd2">cy_wcm_get_ip_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>, &amp;ipv4_addr, 1);</div><div class="line">    <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_ip_addr failed...! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;\nIPV4 address of AP : &quot;</span>);</div><div class="line">    print_ip_4(ipv4_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#acabea09ec2785e76f7d867a74dd6afd7">v4</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Get IPV6 address for AP */</span></div><div class="line">    printf(<span class="stringliteral">&quot;Link Local IPV6 AP address \n&quot;</span>);</div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga6f90e612b2e00a03d13b575a3f759df9">cy_wcm_get_ipv6_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a0a2745fb6696e54ad284f17dbad8755f">CY_WCM_INTERFACE_TYPE_AP</a>, <a class="code" href="group__group__wcm__enums.html#gga04051d082e24439e436a17db75fadfefa635adc564bdb3dbdd71685cef4f470ac">CY_WCM_IPV6_LINK_LOCAL</a>, &amp;ipv6_addr, 1);</div><div class="line">    <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_ipv6_addr failed...! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;\nLink Local IPV6 AP address : &quot;</span>);</div><div class="line">    print_ip_6(ipv6_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Get Link Local IPV6 STA address */</span></div><div class="line">    result = <a class="code" href="group__group__wcm__functions.html#ga6f90e612b2e00a03d13b575a3f759df9">cy_wcm_get_ipv6_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8ae93c4aa9ce482c333a23bdc535df3208">CY_WCM_INTERFACE_TYPE_STA</a>, <a class="code" href="group__group__wcm__enums.html#gga04051d082e24439e436a17db75fadfefa635adc564bdb3dbdd71685cef4f470ac">CY_WCM_IPV6_LINK_LOCAL</a>, &amp;ipv6_addr, 1);</div><div class="line">    <span class="keywordflow">if</span> (result == CY_RSLT_SUCCESS)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;\ncy_wcm_get_ipv6_addr failed...! \n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;\nLink Local IPV6 STA address : &quot;</span>);</div><div class="line">    print_ip_6(ipv6_addr.<a class="code" href="structcy__wcm__ip__address__t.html#ac5cf849d1ad2018fa370b60e13b0024c">ip</a>.<a class="code" href="structcy__wcm__ip__address__t.html#a969244fd2e8b1da5fc07b75c4811e33c">v6</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Get MAC address of both STA and AP interface using CY_WCM_INTERFACE_TYPE_AP_STA */</span></div><div class="line">    <a class="code" href="group__group__wcm__typedefs.html#ga510db2323122294f3956024396ba2ff5">cy_wcm_mac_t</a> *mac_addr_ptr;</div><div class="line">    mac_addr_ptr = (<a class="code" href="group__group__wcm__typedefs.html#ga510db2323122294f3956024396ba2ff5">cy_wcm_mac_t</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="group__group__wcm__typedefs.html#ga510db2323122294f3956024396ba2ff5">cy_wcm_mac_t</a>) *2);</div><div class="line">    <a class="code" href="group__group__wcm__functions.html#ga6e89cb4c8a8ddae25c4078fb64efb61f">cy_wcm_get_mac_addr</a>(<a class="code" href="group__group__wcm__enums.html#ggac4c4ca6db8db6efdc3013b789a4c9cf8a864e150cea33f5d4cae3e6834bf56f2e">CY_WCM_INTERFACE_TYPE_AP_STA</a>, mac_addr_ptr, 2);</div><div class="line">    <a class="code" href="group__group__wcm__typedefs.html#ga510db2323122294f3956024396ba2ff5">cy_wcm_mac_t</a> sta_mac, ap_mac;</div><div class="line">    memcpy(&amp;sta_mac, mac_addr_ptr, <span class="keyword">sizeof</span>(sta_mac));</div><div class="line">    printf(<span class="stringliteral">&quot;mac address of STA = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">            sta_mac[0], sta_mac[1], sta_mac[2],sta_mac[3], sta_mac[4], sta_mac[5]);</div><div class="line">    mac_addr_ptr++;</div><div class="line">    memcpy(&amp;ap_mac, mac_addr_ptr, <span class="keyword">sizeof</span>(ap_mac));</div><div class="line">    printf(<span class="stringliteral">&quot;mac address AP = %02X : %02X : %02X : %02X : %02X : %02X \n&quot;</span>,</div><div class="line">            ap_mac[0], ap_mac[1], ap_mac[2],ap_mac[3], ap_mac[4], ap_mac[5]);</div><div class="line">    free(mac_addr_ptr);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Wi-Fi Connection Manager Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
</body>
</html>
